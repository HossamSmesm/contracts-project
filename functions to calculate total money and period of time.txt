---------total  amount function -------------

CREATE OR REPLACE FUNCTION FUN_INSTALLMENT_AMOUNT (V_CONTRACT_TOTAL_FEES NUMBER , V_CONTRACT_DEPOSIT_FEES NUMBER,V_PAYMENT_INSTALLMENT_NO NUMBER)
RETURN NUMBER
IS 
V_MONEY NUMBER(8,2);

BEGIN

 V_MONEY := (V_CONTRACT_TOTAL_FEES - NVL(V_CONTRACT_DEPOSIT_FEES,0)) /V_PAYMENT_INSTALLMENT_NO;

    RETURN  V_MONEY;  
          
END;

----------date period function------------

CREATE OR REPLACE FUNCTION FUN_INSTALLMENT_PERIOD (V_CONTRACT_PAYMENT_TYPE VARCHAR2, V_CONTRACT_STARTDATE DATE)
RETURN DATE
IS

V_RESULT DATE;

BEGIN

    IF (V_CONTRACT_PAYMENT_TYPE = 'annual')
    THEN
    V_RESULT := ADD_MONTHS( V_CONTRACT_STARTDATE,12);
    ELSIF (V_CONTRACT_PAYMENT_TYPE = 'half annual')
    THEN
    V_RESULT := ADD_MONTHS( V_CONTRACT_STARTDATE,6);
    ELSIF (V_CONTRACT_PAYMENT_TYPE = 'quarter')
    THEN
    V_RESULT := ADD_MONTHS( V_CONTRACT_STARTDATE,3);
    ELSIF (V_CONTRACT_PAYMENT_TYPE = 'monthly')
    THEN
    V_RESULT := ADD_MONTHS( V_CONTRACT_STARTDATE,1);
    END IF;
    RETURN V_RESULT;
END;