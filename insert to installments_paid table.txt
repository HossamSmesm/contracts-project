
CREATE OR REPLACE  PROCEDURE installment_insert IS 
CURSOR installment_cursor IS
SELECT * FROM CONTRACTS;
V_RESULT DATE;
V_MONEY NUMBER(8,2);

BEGIN
FOR V_RECORD IN  installment_cursor
     LOOP

        FOR I IN 1..V_RECORD.PAYMENTS_INSTALLMENTS_NO 
            LOOP

            V_MONEY :=  FUN_INSTALLMENT_AMOUNT ( V_RECORD.CONTRACT_TOTAL_FEES  ,  V_RECORD.CONTRACT_DEPOSIT_FEES , V_RECORD.PAYMENTS_INSTALLMENTS_NO  );
            V_RESULT := FUN_INSTALLMENT_PERIOD ( V_RECORD.CONTRACT_PAYMENT_TYPE ,  V_RECORD.CONTRACT_STARTDATE );
            INSERT INTO INSTALLMENTS_PAID VALUES(New_installments_paid_seq.NEXTVAL,V_RECORD.CONTRACT_ID,V_RECORD.CONTRACT_STARTDATE,V_MONEY ,0);

            V_RECORD.CONTRACT_STARTDATE := V_RESULT;
            END LOOP;
    END LOOP;
END;

show errors;

--------call-------------
DECLARE

BEGIN
 installment_insert;

END;